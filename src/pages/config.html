<!DOCTYPE html>
<html lang=en>

<head>
    <link rel="shortcut icon" type=image/x-icon href=favicon.ico>
    <meta charset=utf-8>
    <meta http-equiv=X-UA-Compatible content="IE=edge">
    <meta name=viewport content="width=device-width, initial-scale=1">
    <link rel=stylesheet href=styles-1.css>
    <title>Configuration</title>
</head>

<body>
    <div class=container>
        <div class="row text-center p-3">
            <h1>ESP32 NAT Router Config <button type="button" class="btn btn-light float-end" data-bs-toggle="modal"
                    data-bs-target="#information" title="Informations">
                    ?
                </button></h1>

        </div>
        <form action=apply method=POST>
            <h2>AP Settings (the new network)</h2> <span class=text-info><span id=clients>%s</span> client(s)
                connected</span>
            <div class="form-group row"> <label for=ap_ssid class=col-3>SSID</label>
                <div class=col-9> <input type=text class=form-control name=ap_ssid id=ap_ssid value=%s maxlength=32
                        placeholder="SSID of the new network"> </div>
            </div>
            <div class="form-group row mt-2"> <label for=ap_password class=col-3>Password</label>
                <div class=col-9>
                    <div class=input-group> <input type=password class="form-control col-9" name=ap_password
                            id=ap_password value=%s maxlength=64 placeholder="Password of the new network"> <span
                            style="cursor: pointer;" class="input-group-text password"
                            title="show password">&#9728;</span> </div>
                </div>
            </div>
            <div class="form-group row col-9 offset-3"> <small class="form-text text-muted">Password less than 8 chars =
                    open</small> </div>
            <h2 class=mt-2>STA Settings (uplink WiFi network)</h2> <span id=sta class=text-%s><span id=symbol>%s</span>
                (signal strength: <span id=db>%s</span> db)</span>
            <div class="form-group row"> <label for=ssid class=col-3>SSID</label>
                <div class=col-9> <input type=text class=form-control name=ssid id=ssid value=%s maxlength=32
                        placeholder="SSID of the existing network"> </div>
            </div>
            <div class="form-group row mt-2"> <label for=password class=col-3>Password</label>
                <div class=col-9>
                    <div class=input-group> <input type=password class=form-control name=password id=password value=%s
                            maxlength=64 placeholder="Password of the existing network"> <span style="cursor: pointer;"
                            class="input-group-text password" title="show password">&#9728;</span> </div>
                </div> <input type=hidden class=form-control name=x value=x>
            </div>
            <div class="form-group row col-4 offset-4 mt-4"> <input type=submit value="Apply changes"
                    class="btn btn-primary"> </div>
        </form>
        <h2 class=mt-2>Device Management</h2>
        <form action=scan method=GET>
            <div class="form-group row col-4 offset-4 mt-2"> <input type=submit value="Wifi Scan" class="btn btn-light">
            </div>
        </form>
        <form action=apply method=POST>
            <div class="form-group row col-4 offset-4 mt-2"> <input type=hidden name=func value=reboot> <input
                    type=submit value=reboot class="btn btn-light"> </div>
        </form>
        <form action=lock method=GET>
            <div class="form-group row col-4 offset-4 mt-2"> <input type=submit value="Lock Interface"
                    class="btn btn-light"> </div>
        </form>
        <form action=unlock method=GET style="display: %s;">
            <div class="form-group row col-4 offset-4 mt-2"> <input type=submit value="Relock Interface"
                    class="btn btn-light"> </div>
        </form>
        <form action=reset method=GET>
            <div class="form-group row col-4 offset-4 mt-5"> <input type=submit value="Erase flash"
                    class="btn btn-warning"> </div>
        </form>
    </div>


    <div class="modal fade" id="information" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body">
                    <table class="table table-striped">
                        <tbody>
                            <tr>
                                <td>Version</td>
                                <td id="version">1.1.1</td>
                            </tr>
                            <tr>
                                <td>Hash</td>
                                <td id="hash">12345</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <script src=jquery.js></script>
    <script src="bootstrap.js"></script>
    <script>     $('.password').on('mousedown mouseup mouseout touchstart touchend', function mouseState(e) { var field = $(this).parent().find('input'); if (e.type == "mousedown" || e.type == "touchstart") { field.get(0).type = 'text'; } else { field.get(0).type = 'password'; } });   </script>
    <script>     (function poll() { $.ajax({ url: "/api", type: "GET", success: function (data) { console.log(data); $('#clients').text(data.clients); $('#db').text(data.strength); $('#sta').removeClass(); $('#sta').addClass('text-' + data.text); $('#symbol').html(data.symbol); }, dataType: "json", complete: setTimeout(function () { poll(); }, 3000), timeout: 3000 }) })();   </script>
</body>

</html>